
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Gravity_Tensor</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-09-22"><meta name="DC.source" content="Gravity_Tensor.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body>

  <p><b><center>Tensor Matrix Graphs with the Original Anomaly</center></b></p>
<img src="result.png"></img>
<center><pre class="codeoutput">Command Used: Gravity_Tensor(1000, 100, 0, 0, 200, 1)</center>
</pre>
<p style="page-break-after:always;"></p>
<p><b><center>Appendix I: MatLab Code, "Gravity_Tensor.m"</center></b></p>

<div class="content"><pre class="codeinput"><span class="comment">%Purpose:</span>
<span class="comment">%   The purpose of this function is to plot the tensor of the gravity response of a point</span>
<span class="comment">%   mass below the surface as a function of your distance from the point</span>
<span class="comment">%   mass using the point mass' mass, location, and depth.</span>

<span class="comment">%Setup:</span>
<span class="comment">%   Coordinate System:</span>
<span class="comment">%       Cartesian</span>
<span class="comment">%           X</span>
<span class="comment">%               Positive    -&gt;  Right</span>
<span class="comment">%               Negative    -&gt;  Left</span>
<span class="comment">%           Y</span>
<span class="comment">%               Positive    -&gt;  Out of Page</span>
<span class="comment">%               Negative    -&gt;  Into Page</span>
<span class="comment">%           Z</span>
<span class="comment">%               Positive    -&gt;  Down</span>
<span class="comment">%               Negative    -&gt;  Up</span>

<span class="comment">%Input:</span>
<span class="comment">%   mass    -&gt;  Mass at the point</span>
<span class="comment">%                   Units: Kilograms</span>
<span class="comment">%   depth   -&gt;  Magnitude of the depth of the point below the x-y plane</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   x_mass  -&gt;  Displacement of the mass in x direction (Positive Right)</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   y_mass  -&gt;  Displacement of the mass in y direction (Positive Out)</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   spread  -&gt;  Distance of axis extension from the origin</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   res     -&gt;  Distance between each gravity response measurement</span>
<span class="comment">%                   Units: Meters</span>

<span class="keyword">function</span> Gravity_Tensor(mass, depth, x_mass, y_mass, spread, res)

<span class="comment">% Number of observations along a line of measurement</span>
obs_total = 2 * spread / res;

<span class="comment">% Setup arrays to store x and y coordinates and the corresponding gravity</span>
<span class="comment">% response</span>
x_obs = zeros(obs_total, obs_total);
y_obs = zeros(obs_total, obs_total);
g_z = zeros(obs_total, obs_total);
T_xx = zeros(obs_total, obs_total);
T_yy = zeros(obs_total, obs_total);
T_zz = zeros(obs_total, obs_total);
T_xy = zeros(obs_total, obs_total);
T_yz = zeros(obs_total, obs_total);
T_xz = zeros(obs_total, obs_total);

<span class="comment">% Iterate through every observation point on the observation grid and store</span>
<span class="comment">% data representing each measurement</span>
<span class="keyword">for</span> i = 1:obs_total
    <span class="keyword">for</span> j = 1:obs_total
        <span class="comment">% Calculate the x and y coordinates of each observation point</span>
        x_obs(i, j) = -1.0 * spread + i * res;
        y_obs(i, j) = -1.0 * spread + j * res;

        <span class="comment">% Calculate the gravity response at a given observation location,</span>
        <span class="comment">% (x,y)</span>
        T = Gravity_Tensor_Matrix(mass, depth, x_mass, y_mass, x_obs(i, j), y_obs(i, j), 0);
        g = Gravity_Response_Vector(mass, depth, x_mass, y_mass, x_obs(i, j), y_obs(i, j), 0);
        g_z(i, j) = g(3);
        T_xx(i, j) = T(1, 1);
        T_yy(i, j) = T(2, 2);
        T_zz(i, j) = T(3, 3);
        T_xy(i, j) = T(1, 2);
        T_yz(i, j) = T(2, 3);
        T_xz(i, j) = T(1, 3);
    <span class="keyword">end</span>;
<span class="keyword">end</span>;

<span class="comment">% Graph the data as a surface contour.</span>

subplot(3, 3, 7);
surfc(x_obs, y_obs, g_z, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
title(<span class="string">'Original Anomaly: Gz'</span>);
xlabel(<span class="string">'X (m)'</span>);
ylabel(<span class="string">'Y (m)'</span>);
c = colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
xlabel(c, <span class="string">'mGal'</span>);

subplot(3, 3, 1);
surfc(x_obs, y_obs, T_xx, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
title(<span class="string">'Txx'</span>);
xlabel(<span class="string">'X (m)'</span>);
ylabel(<span class="string">'Y (m)'</span>);
colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
c = colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
xlabel(c, <span class="string">'Eotvos'</span>);

subplot(3, 3, 5);
surfc(x_obs, y_obs, T_yy, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
title(<span class="string">'Tyy'</span>);
xlabel(<span class="string">'X (m)'</span>);
ylabel(<span class="string">'Y (m)'</span>);
colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
c = colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
xlabel(c, <span class="string">'Eotvos'</span>);

subplot(3, 3, 9);
surfc(x_obs, y_obs, T_zz, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
title(<span class="string">'Tzz'</span>);
xlabel(<span class="string">'X (m)'</span>);
ylabel(<span class="string">'Y (m)'</span>);
colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
c = colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
xlabel(c, <span class="string">'Eotvos'</span>);

subplot(3, 3, 2);
surfc(x_obs, y_obs, T_xy, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
title(<span class="string">'Txy'</span>);
xlabel(<span class="string">'X (m)'</span>);
ylabel(<span class="string">'Y (m)'</span>);
colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
c = colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
xlabel(c, <span class="string">'Eotvos'</span>);

subplot(3, 3, 6);
surfc(x_obs, y_obs, T_yz, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
title(<span class="string">'Tyz'</span>);
xlabel(<span class="string">'X (m)'</span>);
ylabel(<span class="string">'Y (m)'</span>);
colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
c = colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
xlabel(c, <span class="string">'Eotvos'</span>);

subplot(3, 3, 3);
surfc(x_obs, y_obs, T_xz, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
title(<span class="string">'Txz'</span>);
xlabel(<span class="string">'X (m)'</span>);
ylabel(<span class="string">'Y (m)'</span>);
colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
c = colorbar(<span class="string">'location'</span>,<span class="string">'eastoutside'</span>);
xlabel(c, <span class="string">'Eotvos'</span>);


<span class="comment">%Input:</span>
<span class="comment">%   mass    -&gt;  Mass at the point</span>
<span class="comment">%                   Units: Kilograms</span>
<span class="comment">%   depth   -&gt;  Magnitude of the depth of the point below the x-y plane</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   x_mass  -&gt;  Displacement of the mass in the x direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   y_mass  -&gt;  Displacement of the mass in the y direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   x_obs   -&gt;  Displacement of the observation point in the x direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   y_obs   -&gt;  Displacement of the observation point in the y direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   z_obs   -&gt;  Displacement of the observation point in the z direction</span>
<span class="comment">%                   Units: Meters</span>

<span class="comment">%Output:</span>
<span class="comment">%   T:  Tensor Matrix for cartesian coordinate system</span>
<span class="comment">%</span>
<span class="comment">%       |T_xx,T_xy,T_xz|</span>
<span class="comment">%   T = |T_yx,T_yy,T_yz|</span>
<span class="comment">%       |T_zx,T_zy,T_zz|</span>
<span class="comment">%</span>
<span class="comment">%       Units:  Eotvos</span>

<span class="keyword">function</span> T = Gravity_Tensor_Matrix(mass, depth, x_mass, y_mass, x_obs, y_obs, z_obs)

<span class="comment">%Constants</span>
<span class="comment">%   big_g   -&gt;  The Universal Gravitational Constant</span>
<span class="comment">%                   Units: (Meters)^(3) * (Kilograms)^(-1) * (Seconds)^(-2)</span>
<span class="comment">%   g_conv  -&gt;  Conversion ratio from (Meter) * (Seconds)^(-2) to milliGals</span>
<span class="comment">%                   Units: None</span>
<span class="comment">%   r_sqrd  -&gt;  Radius from the observation point squared</span>
<span class="comment">%                   Units: (Meters)^2</span>

big_g   = 6.67384E-11;
g_conv  = 1000000000;
r_sqrd = ((x_obs - x_mass)^2 + (y_obs - y_mass)^2 + (z_obs + abs(depth))^2);

coefficient = (g_conv * big_g * abs(mass));

<span class="comment">%   Return Tensor Matrix</span>
T(1, 1) = coefficient * ((3) * (x_obs - x_mass)^(2) * r_sqrd^(-5/2) - r_sqrd^(-3/2));
T(1, 2) = coefficient * ((3) * (y_obs - y_mass) * (x_obs - x_mass) * r_sqrd^(-5/2));
T(1, 3) = coefficient * ((-3) * (z_obs + abs(depth)) * (x_obs - x_mass) * r_sqrd^(-5/2));
T(2, 2) = coefficient * ((3) * (y_obs - y_mass)^(2) * r_sqrd^(-5/2) - r_sqrd^(-3/2));
T(2, 3) = coefficient * ((-3) * (z_obs + abs(depth)) * (y_obs - y_mass) * r_sqrd^(-5/2));
T(3, 3) = coefficient * ((3) * (z_obs + abs(depth))^(2) * r_sqrd^(-5/2) - r_sqrd^(-3/2));


<span class="comment">%Input:</span>
<span class="comment">%   mass    -&gt;  Mass at the point</span>
<span class="comment">%                   Units: Kilograms</span>
<span class="comment">%   depth   -&gt;  Magnitude of the depth of the point below the x-y plane</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   x_mass  -&gt;  Displacement of the mass in the x direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   y_mass  -&gt;  Displacement of the mass in the y direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   x_obs   -&gt;  Displacement of the observation point in the x direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   y_obs   -&gt;  Displacement of the observation point in the y direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%   z_obs   -&gt;  Displacement of the observation point in the z direction</span>
<span class="comment">%                   Units: Meters</span>
<span class="comment">%</span>
<span class="comment">%Output:</span>
<span class="comment">%   g       -&gt;  Three component gravity response vector &lt;x, y, z&gt;</span>
<span class="comment">%                   Units: mGal</span>


<span class="keyword">function</span> g = Gravity_Response_Vector(mass, depth, x_mass, y_mass, x_obs, y_obs, z_obs)

<span class="comment">%Constants</span>
<span class="comment">%   big_g   -&gt;  The Universal Gravitational Constant</span>
<span class="comment">%                   Units: (Meters)^(3) * (Kilograms)^(-1) * (Seconds)^(-2)</span>
<span class="comment">%   g_conv  -&gt;  Conversion ratio from (Meter) * (Seconds)^(-2) to milliGals</span>
<span class="comment">%                   Units: None</span>
<span class="comment">%   r_sqrd  -&gt;  Radius from the observation point squared</span>
<span class="comment">%                   Units: (Meters)^2</span>

big_g   = 6.67384E-11;
g_conv  = 100000;
r_sqrd = ((x_obs - x_mass)^2 + (y_obs - y_mass)^2 + (z_obs + abs(depth))^2);

coefficient = (g_conv * big_g * abs(mass)) / (r_sqrd ^ (3/2));

<span class="comment">%   Return Gravity Response Vector</span>
g(1) = coefficient * (x_obs - x_mass);
g(2) = coefficient * (y_obs - y_mass);
g(3) = coefficient * (z_obs + abs(depth));
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%Purpose:
%   The purpose of this function is to plot the tensor of the gravity response of a point
%   mass below the surface as a function of your distance from the point
%   mass using the point mass' mass, location, and depth.

%Setup:
%   Coordinate System:
%       Cartesian
%           X
%               Positive    ->  Right
%               Negative    ->  Left 
%           Y
%               Positive    ->  Out of Page
%               Negative    ->  Into Page
%           Z
%               Positive    ->  Down
%               Negative    ->  Up

%Input: 
%   mass    ->  Mass at the point
%                   Units: Kilograms
%   depth   ->  Magnitude of the depth of the point below the x-y plane 
%                   Units: Meters
%   x_mass  ->  Displacement of the mass in x direction (Positive Right)
%                   Units: Meters
%   y_mass  ->  Displacement of the mass in y direction (Positive Out)
%                   Units: Meters
%   spread  ->  Distance of axis extension from the origin
%                   Units: Meters
%   res     ->  Distance between each gravity response measurement
%                   Units: Meters

function Gravity_Tensor(mass, depth, x_mass, y_mass, spread, res)

% Number of observations along a line of measurement
obs_total = 2 * spread / res;

% Setup arrays to store x and y coordinates and the corresponding gravity
% response
x_obs = zeros(obs_total, obs_total);
y_obs = zeros(obs_total, obs_total);
g_z = zeros(obs_total, obs_total);
T_xx = zeros(obs_total, obs_total);
T_yy = zeros(obs_total, obs_total);
T_zz = zeros(obs_total, obs_total);
T_xy = zeros(obs_total, obs_total);
T_yz = zeros(obs_total, obs_total);
T_xz = zeros(obs_total, obs_total);

% Iterate through every observation point on the observation grid and store
% data representing each measurement
for i = 1:obs_total
    for j = 1:obs_total
        % Calculate the x and y coordinates of each observation point
        x_obs(i, j) = -1.0 * spread + i * res;
        y_obs(i, j) = -1.0 * spread + j * res;
        
        % Calculate the gravity response at a given observation location,
        % (x,y)
        T = Gravity_Tensor_Matrix(mass, depth, x_mass, y_mass, x_obs(i, j), y_obs(i, j), 0);
        g = Gravity_Response_Vector(mass, depth, x_mass, y_mass, x_obs(i, j), y_obs(i, j), 0);
        g_z(i, j) = g(3);
        T_xx(i, j) = T(1, 1);
        T_yy(i, j) = T(2, 2);
        T_zz(i, j) = T(3, 3);
        T_xy(i, j) = T(1, 2);
        T_yz(i, j) = T(2, 3);
        T_xz(i, j) = T(1, 3);
    end;
end;

% Graph the data as a surface contour.

subplot(3, 3, 7);
surfc(x_obs, y_obs, g_z, 'EdgeColor', 'none');
title('Original Anomaly: Gz');
xlabel('X (m)');
ylabel('Y (m)');
c = colorbar('location','eastoutside');
xlabel(c, 'mGal');

subplot(3, 3, 1);
surfc(x_obs, y_obs, T_xx, 'EdgeColor', 'none');
title('Txx');
xlabel('X (m)');
ylabel('Y (m)');
colorbar('location','eastoutside');
c = colorbar('location','eastoutside');
xlabel(c, 'Eotvos');

subplot(3, 3, 5);
surfc(x_obs, y_obs, T_yy, 'EdgeColor', 'none');
title('Tyy');
xlabel('X (m)');
ylabel('Y (m)');
colorbar('location','eastoutside');
c = colorbar('location','eastoutside');
xlabel(c, 'Eotvos');

subplot(3, 3, 9);
surfc(x_obs, y_obs, T_zz, 'EdgeColor', 'none');
title('Tzz');
xlabel('X (m)');
ylabel('Y (m)');
colorbar('location','eastoutside');
c = colorbar('location','eastoutside');
xlabel(c, 'Eotvos');

subplot(3, 3, 2);
surfc(x_obs, y_obs, T_xy, 'EdgeColor', 'none');
title('Txy');
xlabel('X (m)');
ylabel('Y (m)');
colorbar('location','eastoutside');
c = colorbar('location','eastoutside');
xlabel(c, 'Eotvos');

subplot(3, 3, 6);
surfc(x_obs, y_obs, T_yz, 'EdgeColor', 'none');
title('Tyz');
xlabel('X (m)');
ylabel('Y (m)');
colorbar('location','eastoutside');
c = colorbar('location','eastoutside');
xlabel(c, 'Eotvos');

subplot(3, 3, 3);
surfc(x_obs, y_obs, T_xz, 'EdgeColor', 'none');
title('Txz');
xlabel('X (m)');
ylabel('Y (m)');
colorbar('location','eastoutside');
c = colorbar('location','eastoutside');
xlabel(c, 'Eotvos');


%Input: 
%   mass    ->  Mass at the point
%                   Units: Kilograms
%   depth   ->  Magnitude of the depth of the point below the x-y plane 
%                   Units: Meters
%   x_mass  ->  Displacement of the mass in the x direction
%                   Units: Meters
%   y_mass  ->  Displacement of the mass in the y direction
%                   Units: Meters
%   x_obs   ->  Displacement of the observation point in the x direction
%                   Units: Meters
%   y_obs   ->  Displacement of the observation point in the y direction
%                   Units: Meters
%   z_obs   ->  Displacement of the observation point in the z direction
%                   Units: Meters

%Output:
%   T:  Tensor Matrix for cartesian coordinate system
%   
%       |T_xx,T_xy,T_xz|
%   T = |T_yx,T_yy,T_yz|
%       |T_zx,T_zy,T_zz|
%
%       Units:  Eotvos

function T = Gravity_Tensor_Matrix(mass, depth, x_mass, y_mass, x_obs, y_obs, z_obs)

%Constants
%   big_g   ->  The Universal Gravitational Constant
%                   Units: (Meters)^(3) * (Kilograms)^(-1) * (Seconds)^(-2)
%   g_conv  ->  Conversion ratio from (Meter) * (Seconds)^(-2) to milliGals
%                   Units: None
%   r_sqrd  ->  Radius from the observation point squared
%                   Units: (Meters)^2

big_g   = 6.67384E-11;
g_conv  = 1000000000;
r_sqrd = ((x_obs - x_mass)^2 + (y_obs - y_mass)^2 + (z_obs + abs(depth))^2);

coefficient = (g_conv * big_g * abs(mass));

%   Return Tensor Matrix
T(1, 1) = coefficient * ((3) * (x_obs - x_mass)^(2) * r_sqrd^(-5/2) - r_sqrd^(-3/2));
T(1, 2) = coefficient * ((3) * (y_obs - y_mass) * (x_obs - x_mass) * r_sqrd^(-5/2));
T(1, 3) = coefficient * ((-3) * (z_obs + abs(depth)) * (x_obs - x_mass) * r_sqrd^(-5/2));
T(2, 2) = coefficient * ((3) * (y_obs - y_mass)^(2) * r_sqrd^(-5/2) - r_sqrd^(-3/2));
T(2, 3) = coefficient * ((-3) * (z_obs + abs(depth)) * (y_obs - y_mass) * r_sqrd^(-5/2));
T(3, 3) = coefficient * ((3) * (z_obs + abs(depth))^(2) * r_sqrd^(-5/2) - r_sqrd^(-3/2));


%Input: 
%   mass    ->  Mass at the point
%                   Units: Kilograms
%   depth   ->  Magnitude of the depth of the point below the x-y plane 
%                   Units: Meters
%   x_mass  ->  Displacement of the mass in the x direction
%                   Units: Meters
%   y_mass  ->  Displacement of the mass in the y direction
%                   Units: Meters
%   x_obs   ->  Displacement of the observation point in the x direction
%                   Units: Meters
%   y_obs   ->  Displacement of the observation point in the y direction
%                   Units: Meters
%   z_obs   ->  Displacement of the observation point in the z direction
%                   Units: Meters
%
%Output:
%   g       ->  Three component gravity response vector <x, y, z>
%                   Units: mGal


function g = Gravity_Response_Vector(mass, depth, x_mass, y_mass, x_obs, y_obs, z_obs)

%Constants
%   big_g   ->  The Universal Gravitational Constant
%                   Units: (Meters)^(3) * (Kilograms)^(-1) * (Seconds)^(-2)
%   g_conv  ->  Conversion ratio from (Meter) * (Seconds)^(-2) to milliGals
%                   Units: None
%   r_sqrd  ->  Radius from the observation point squared
%                   Units: (Meters)^2

big_g   = 6.67384E-11;
g_conv  = 100000;
r_sqrd = ((x_obs - x_mass)^2 + (y_obs - y_mass)^2 + (z_obs + abs(depth))^2);

coefficient = (g_conv * big_g * abs(mass)) / (r_sqrd ^ (3/2));

%   Return Gravity Response Vector
g(1) = coefficient * (x_obs - x_mass);
g(2) = coefficient * (y_obs - y_mass);
g(3) = coefficient * (z_obs + abs(depth));

##### SOURCE END #####
--></body></html>